SELECT
    s.NBR_STRCID,
    s.NBR_SRCACCT,
    s.COD_GL,
    s.COD_HSBCNETREPID,
    s.REP_ID,
    s.NBR_INSTRID,
    s.NBR_COREACCT,
    s.DAT_BUSINESS,
    s.TXT_STATUS,
    s.LOTID,
    s.REP_SEQ,
    s.NBR_TGTACCT,
    s.FLG_TGT_ACC_TYPE,
    s.FLG_SRC_ACC_TYPE,
    s.ACCT_NOMINATED_DRAINPOOL,
    e.ACCOUNT_ID,
    e.REPORT_CODE,
    e.REP_EXEC_ID,
    e.INSTRID,
    e.POOL_ID,
    e.PARTICIPANT_ID,
    e.DAT_BUSINESS AS EXEC_DAT_BUSINESS,
    e.TXT_STATUS AS EXEC_TXT_STATUS,
    e.REPORT_NAME,
    e.REPORT_TYPE,
    e.ERROR_MESSAGE,
    e.GENERATION_DATE_TIME,
    e.FILENAME,
    e.ARCHIVED_FILE_LOCATION,
    e.ACCOUNT_NUMBER,
    e.HSBCNET_TRANSFER,
    e.RFD_META_DATA_FILE_NAME
FROM
    SNAPSHOT s
LEFT JOIN
    EXEC_LOG e ON s.NBR_STRCID = e.STRUCTURE_ID
               AND s.NBR_SRCACCT = e.ACCOUNT_ID
               AND s.COD_GL = e.COD_GL
               AND s.COD_HSBCNETREPID = e.REPORT_CODE
WHERE
    (e.STRUCTURE_ID IN ('1', '221', '334') OR e.STRUCTURE_ID IS NULL)  -- 包含NULL的情况以匹配LEFT JOIN
    AND s.DAT_BUSINESS = TO_DATE('22-OCT-24', 'DD-MON-RR');
